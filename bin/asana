#!/usr/bin/env ruby
require 'asana'
require 'smart_asana'

attrs = SmartAsana.parse(ARGV[0])

Asana.configure do |client|
  client.api_key = ENV['ASANA_API_KEY']
end

workspaces = Asana::Workspace.all

workspace = workspaces.select{ |w|
  w.name.downcase == attrs[:workspace].downcase
}.first

attrs.delete(:workspace)

workspace ||= workspaces.first

workspace.create_task(attrs)
